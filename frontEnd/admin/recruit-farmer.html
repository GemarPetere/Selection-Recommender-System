<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Recommender System | Recruit</title>

    <!-- Google Font: Source Sans Pro -->
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback"
    />
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="plugins/fontawesome-free/css/all.min.css" />
    <!-- Theme style -->
    <link rel="stylesheet" href="dist/css/adminlte.min.css" />
    <script src="https://api.mapbox.com/mapbox-gl-js/v1.6.1/mapbox-gl.js"></script>
  </head>
  <body class="hold-transition sidebar-mini">
    <div class="wrapper">
      <!-- Navbar -->
      <nav class="main-header navbar navbar-expand navbar-white navbar-light">
        <!-- Left navbar links -->
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link" data-widget="pushmenu" href="#" role="button"
              ><i class="fas fa-bars"></i
            ></a>
          </li>
          <li class="nav-item d-none d-sm-inline-block">
            <a href="index3.html" class="nav-link">Home</a>
          </li>
          <li class="nav-item d-none d-sm-inline-block">
            <a href="#" class="nav-link">Contact</a>
          </li>
        </ul>

        <!-- Right navbar links -->
        <ul class="navbar-nav ml-auto">
          <!-- Navbar Search -->
          <li class="nav-item">
            <a
              class="nav-link"
              data-widget="navbar-search"
              href="#"
              role="button"
            >
              <i class="fas fa-search"></i>
            </a>
            <div class="navbar-search-block">
              <form class="form-inline">
                <div class="input-group input-group-sm">
                  <input
                    class="form-control form-control-navbar"
                    type="search"
                    placeholder="Search"
                    aria-label="Search"
                  />
                  <div class="input-group-append">
                    <button class="btn btn-navbar" type="submit">
                      <i class="fas fa-search"></i>
                    </button>
                    <button
                      class="btn btn-navbar"
                      type="button"
                      data-widget="navbar-search"
                    >
                      <i class="fas fa-times"></i>
                    </button>
                  </div>
                </div>
              </form>
            </div>
          </li>

          <!-- Messages Dropdown Menu -->
          <li class="nav-item dropdown">
            <a class="nav-link" data-toggle="dropdown" href="#">
              <i class="far fa-comments"></i>
              <span class="badge badge-danger navbar-badge">3</span>
            </a>
            <div class="dropdown-menu dropdown-menu-lg dropdown-menu-right">
              <a href="#" class="dropdown-item">
                <!-- Message Start -->
                <div class="media">
                  <img
                    src="dist/img/user1-128x128.jpg"
                    alt="User Avatar"
                    class="img-size-50 mr-3 img-circle"
                  />
                  <div class="media-body">
                    <h3 class="dropdown-item-title">
                      Brad Diesel
                      <span class="float-right text-sm text-danger"
                        ><i class="fas fa-star"></i
                      ></span>
                    </h3>
                    <p class="text-sm">Call me whenever you can...</p>
                    <p class="text-sm text-muted">
                      <i class="far fa-clock mr-1"></i> 4 Hours Ago
                    </p>
                  </div>
                </div>
                <!-- Message End -->
              </a>
              <div class="dropdown-divider"></div>
              <a href="#" class="dropdown-item">
                <!-- Message Start -->
                <div class="media">
                  <img
                    src="dist/img/user8-128x128.jpg"
                    alt="User Avatar"
                    class="img-size-50 img-circle mr-3"
                  />
                  <div class="media-body">
                    <h3 class="dropdown-item-title">
                      John Pierce
                      <span class="float-right text-sm text-muted"
                        ><i class="fas fa-star"></i
                      ></span>
                    </h3>
                    <p class="text-sm">I got your message bro</p>
                    <p class="text-sm text-muted">
                      <i class="far fa-clock mr-1"></i> 4 Hours Ago
                    </p>
                  </div>
                </div>
                <!-- Message End -->
              </a>
              <div class="dropdown-divider"></div>
              <a href="#" class="dropdown-item">
                <!-- Message Start -->
                <div class="media">
                  <img
                    src="dist/img/user3-128x128.jpg"
                    alt="User Avatar"
                    class="img-size-50 img-circle mr-3"
                  />
                  <div class="media-body">
                    <h3 class="dropdown-item-title">
                      Nora Silvester
                      <span class="float-right text-sm text-warning"
                        ><i class="fas fa-star"></i
                      ></span>
                    </h3>
                    <p class="text-sm">The subject goes here</p>
                    <p class="text-sm text-muted">
                      <i class="far fa-clock mr-1"></i> 4 Hours Ago
                    </p>
                  </div>
                </div>
                <!-- Message End -->
              </a>
              <div class="dropdown-divider"></div>
              <a href="#" class="dropdown-item dropdown-footer"
                >See All Messages</a
              >
            </div>
          </li>
          <!-- Notifications Dropdown Menu -->
          <li class="nav-item dropdown">
            <a class="nav-link" data-toggle="dropdown" href="#">
              <i class="far fa-bell"></i>
              <span class="badge badge-warning navbar-badge">15</span>
            </a>
            <div class="dropdown-menu dropdown-menu-lg dropdown-menu-right">
              <span class="dropdown-header">15 Notifications</span>
              <div class="dropdown-divider"></div>
              <a href="#" class="dropdown-item">
                <i class="fas fa-envelope mr-2"></i> 4 new messages
                <span class="float-right text-muted text-sm">3 mins</span>
              </a>
              <div class="dropdown-divider"></div>
              <a href="#" class="dropdown-item">
                <i class="fas fa-users mr-2"></i> 8 friend requests
                <span class="float-right text-muted text-sm">12 hours</span>
              </a>
              <div class="dropdown-divider"></div>
              <a href="#" class="dropdown-item">
                <i class="fas fa-file mr-2"></i> 3 new reports
                <span class="float-right text-muted text-sm">2 days</span>
              </a>
              <div class="dropdown-divider"></div>
              <a href="#" class="dropdown-item dropdown-footer"
                >See All Notifications</a
              >
            </div>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-widget="fullscreen" href="#" role="button">
              <i class="fas fa-expand-arrows-alt"></i>
            </a>
          </li>
          <li class="nav-item">
            <a
              class="nav-link"
              data-widget="control-sidebar"
              data-slide="true"
              href="#"
              role="button"
            >
              <i class="fas fa-th-large"></i>
            </a>
          </li>
        </ul>
      </nav>
      <!-- /.navbar -->

      <!-- Main Sidebar Container -->
      <div class="_sidebar"></div>

      <!-- Content Wrapper. Contains page content -->
      <div class="content-wrapper">
        <!-- Content Header (Page header) -->
        <section class="content-header">
          <div class="container-fluid">
            <div class="row mb-2">
              <div class="col-sm-6">
                <h1>Register a Farmer</h1>
              </div>
              <div class="col-sm-6">
                <ol class="breadcrumb float-sm-right">
                  <li class="breadcrumb-item"><a href="#">Home</a></li>
                  <li class="breadcrumb-item active">Project Add</li>
                </ol>
              </div>
            </div>
          </div>
          <!-- /.container-fluid -->
        </section>

        <!-- Main content -->
        <section class="content">
          <div class="row">
            <div class="col-md-8">
              <div class="card">
                <!-- <div class="card-header">
                  <h3 class="card-title">General</h3>

                  <div class="card-tools">
                    <button
                      type="button"
                      class="btn btn-tool"
                      data-card-widget="collapse"
                      title="Collapse"
                    >
                      <i class="fas fa-minus"></i>
                    </button>
                  </div>
                </div> -->
                <div class="card-body">
                  <div class="row">
                    <div class="col-4">
                      <div class="form-group">
                        <label for="inputName">First Name</label>
                        <input
                          type="text"
                          id="firstName"
                          class="form-control"
                        />
                      </div>
                    </div>
                    <div class="col-4">
                      <div class="form-group">
                        <label for="inputName">Last Name</label>
                        <input type="text" id="lastName" class="form-control" />
                      </div>
                    </div>
                    <div class="col-2">
                      <div class="form-group">
                        <label for="inputName">Middle Initial</label>
                        <input type="text" id="lastName" class="form-control" />
                      </div>
                    </div>
                    <div class="col-2">
                      <div class="form-group">
                        <label for="inputName">Suffix</label>
                        <input type="text" id="lastName" class="form-control" />
                      </div>
                    </div>
                    <div class="col-12">
                      <div class="form-group">
                        <label for="inputName">Address</label>
                        <input type="text" id="lastName" class="form-control" />
                      </div>
                    </div>
                    <div class="col-12">
                      <div class="form-group">
                        <label for="inputStatus">Status</label>
                        <select
                          id="inputStatus"
                          class="form-control custom-select"
                        >
                          <option selected disabled>Select one</option>
                          <option>On Hold</option>
                          <option>Canceled</option>
                          <option>Success</option>
                        </select>
                      </div>
                    </div>
                    <div class="col-12">
                      <div class="form-group">
                        <label for="inputClientCompany">Client Company</label>
                        <input
                          type="text"
                          id="inputClientCompany"
                          class="form-control"
                        />
                      </div>
                    </div>
                    <div class="col-12">
                      <div class="form-group">
                        <label for="inputProjectLeader">Project Leader</label>
                        <input
                          type="text"
                          id="inputProjectLeader"
                          class="form-control"
                        />
                      </div>
                    </div>
                  </div>
                </div>
                <!-- /.card-body -->
              </div>
              <!-- /.card -->
            </div>
            <div class="col-md-4">
              <div class="card">
                <div class="card-header">
                  <h3 class="card-title">Add Location</h3>

                  <div class="card-tools">
                    <button
                      type="button"
                      class="btn btn-tool"
                      data-card-widget="collapse"
                      title="Collapse"
                    >
                      <i class="fas fa-minus"></i>
                    </button>
                  </div>
                </div>
                <div class="card-body">
                  <div id="map" style="height:381px;"></div>
                </div>
                <!-- /.card-body -->
              </div>
              <!-- /.card -->
            </div>
          </div>
          <div class="row">
            <div class="col-12">
              <a href="#" class="btn btn-secondary">Cancel</a>
              <input
                type="submit"
                value="Add New Farmer"
                class="btn btn-success float-right"
              />
            </div>
          </div>
        </section>
        <!-- /.content -->
      </div>
      <!-- /.content-wrapper -->

      <!-- Control Sidebar -->
      <aside class="control-sidebar control-sidebar-dark">
        <!-- Control sidebar content goes here -->
        <div class="p-3">
          <h5>Title</h5>
          <p>Sidebar content</p>
        </div>
      </aside>
    </div>
    <!-- ./wrapper -->

    <!-- REQUIRED SCRIPTS -->

    <!-- jQuery -->
    <script src="plugins/jquery/jquery.min.js"></script>
    <!-- Bootstrap 4 -->
    <script src="plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
    <!-- AdminLTE App -->
    <script src="dist/js/adminlte.min.js"></script>
    <script src="dist/js/sidebar.js"></script>

    <script>
      "use strict";

      // Initialize Map
      mapboxgl.accessToken =
        "pk.eyJ1IjoiYmVuamllYmVuIiwiYSI6ImNrNXQ1M3IyczBza2YzbnBib2VjbnRrNnQifQ.xhXbsTEg6vZmrjr27iSs3g";

      let map = new mapboxgl.Map({
        container: "map",
        style: "mapbox://styles/mapbox/streets-v11",
        center: [126.219766, 6.959205],
        zoom: 15,
        attributionControl: false,
      });

      // Add geolocate control to the map.
      let geolocate = new mapboxgl.GeolocateControl({
        positionOptions: {
          enableHighAccuracy: true,
        },
        trackUserLocation: true,
      });

      map.addControl(geolocate);
      geolocate.on("geolocate", function (event) {
        // console.log('event fired: ', event);
        // console.log('Coords: ', event.coords);
        // console.log('Latitude', event.coords.latitude);
        // console.log('Longitude', event.coords.longitude);
        let coordinates = event.coords.longitude + "," + event.coords.latitude;
        let lngLatValues = {
          lng: event.coords.longitude,
          lat: event.coords.latitude,
        };

        let url =
          "https://api.mapbox.com/geocoding/v5/mapbox.places/" +
          coordinates +
          ".json?access_token=pk.eyJ1IjoiYmVuamllYmVuIiwiYSI6ImNrNXQ1M3IyczBza2YzbnBib2VjbnRrNnQifQ.xhXbsTEg6vZmrjr27iSs3g";
        let xmlHttp = new XMLHttpRequest();
        xmlHttp.open("GET", url, false); // false for synchronous request
        xmlHttp.send(null);
        let result = JSON.parse(xmlHttp.responseText);

        let r = result.features[1].place_name;
        if (document.getElementById("address").value == "") {
          marker1 = new mapboxgl.Marker().setLngLat(lngLatValues).addTo(map);
          document.getElementById("address").value = "[" + coordinates + "]";
          document.getElementById("coordinatesPin").innerHTML =
            ":<strong>" + r + "</strong>";
          document.getElementById("location").value = r;
        } else {
          marker1.remove();
          marker1 = new mapboxgl.Marker().setLngLat(lngLatValues).addTo(map);
          document.getElementById("address").value = "[" + coordinates + "]";
          document.getElementById("coordinatesPin").innerHTML =
            ":<strong>" + r + "</strong>";
          document.getElementById("location").value = r;
        }
      });

      let marker1;
      map.on("click", function (e) {
        let t = JSON.stringify(e.lngLat.wrap());
        let u = JSON.parse(t);
        let coordinates = u["lng"] + "," + u["lat"];
        let url =
          "https://api.mapbox.com/geocoding/v5/mapbox.places/" +
          coordinates +
          ".json?access_token=pk.eyJ1IjoiYmVuamllYmVuIiwiYSI6ImNrNXQ1M3IyczBza2YzbnBib2VjbnRrNnQifQ.xhXbsTEg6vZmrjr27iSs3g";

        let xmlHttp = new XMLHttpRequest();
        xmlHttp.open("GET", url, false); // false for synchronous request
        xmlHttp.send(null);
        let result = JSON.parse(xmlHttp.responseText);
        // let r=result.features[1].place_name.replace(/\d+|^\s+|\s+$/g,'');
        // let r = result.features[1].place_name;
        // if (document.getElementById("address").value == "") {
        //   marker1 = new mapboxgl.Marker().setLngLat(e.lngLat).addTo(map);
        //   document.getElementById("address").value = e.lngLat;
        //   document.getElementById("coordinatesPin").innerHTML =
        //     ":<strong>" + r + "</strong>";
        //   document.getElementById("location").value = r;
        // } else {
        //   marker1.remove();
        //   marker1 = new mapboxgl.Marker().setLngLat(e.lngLat).addTo(map);
        //   document.getElementById("address").value = e.lngLat;
        //   document.getElementById("coordinatesPin").innerHTML =
        //     ":<strong>" + r + "</strong>";
        //   document.getElementById("location").value = r;
        // }
      });

      /* 
    Create a popup, specify its options 
    and properties, and add it to the map.
  */
      const popup = new mapboxgl.Popup({ offset: [0, -15] })
        .setLngLat(feature.geometry.coordinates)
        .setHTML(
          `<h3>${feature.properties.title}</h3><p>${feature.properties.description}</p>`
        )
        .addTo(map);

      /* 
Add an event listener that runs
  when a user clicks on the map element.
*/
      map.on("click", (event) => {
        // If the user clicked on one of your markers, get its information.
        const features = map.queryRenderedFeatures(event.point, {
          layers: ["YOUR_LAYER_NAME"], // replace with your layer name
        });
        if (!features.length) {
          return;
        }
        const feature = features[0];

        // Code from the next step will go here.
      });
    </script>
  </body>
</html>
